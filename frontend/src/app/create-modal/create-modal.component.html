<div class="modal">
  <div class="modal-content">
    <form #personForm="ngForm" (ngSubmit)="onSubmit(personForm)">
      <h2>Neuen Verwandten anlegen</h2>

      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      <div class="row">
        <div class="form-group">
          <label for="firstName">Vorname *</label>
          <input
            type="text"
            id="firstName"
            name="firstName"
            ngModel
            required
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="middleName">Zwischenname</label>
          <input
            type="text"
            id="middleName"
            name="middleName"
            ngModel
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="lastName">Nachname *</label>
          <input
            type="text"
            id="lastName"
            name="lastName"
            ngModel
            required
            [disabled]="isLoading"
          />
        </div>
      </div>

      <div class="row">
        <div class="form-group">
          <label for="birthName">Geburtsname</label>
          <input
            type="text"
            id="birthName"
            name="birthName"
            ngModel
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="artistName">K체nstlername</label>
          <input
            type="text"
            id="artistName"
            name="artistName"
            ngModel
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="gender">Geschlecht</label>
          <select id="gender" name="gender" ngModel="U" [disabled]="isLoading">
            <option value="U">Unbekannt</option>
            <option value="M">M채nnlich</option>
            <option value="F">Weiblich</option>
            <option value="N">Nicht-bin채r</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="form-group">
          <label for="dob">Geburtsdatum</label>
          <input
            type="date"
            id="dob"
            name="dob"
            ngModel
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="pob">Geburtsort</label>
          <input
            type="text"
            id="pob"
            name="pob"
            ngModel
            [disabled]="isLoading"
          />
        </div>
      </div>

      <div class="row">
        <div class="form-group">
          <label for="dod">Todesdatum</label>
          <input
            type="date"
            id="dod"
            name="dod"
            ngModel
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="pod">Todesort</label>
          <input
            type="text"
            id="pod"
            name="pod"
            ngModel
            [disabled]="isLoading"
          />
        </div>
      </div>

      <div class="row">
        <div class="form-group full-width">
          <label for="cod">Todesursache</label>
          <input
            type="text"
            id="cod"
            name="cod"
            ngModel
            [disabled]="isLoading"
          />
        </div>
      </div>

      <div class="row">
        <div class="form-group">
          <label for="mother">Mutter</label>
          <select id="mother" name="mother" ngModel [disabled]="isLoading">
            <option [value]="null">-- Keine --</option>
            <option *ngFor="let person of allPersons" [value]="person.id">
              {{ person.first_name }} {{ person.last_name }}
              <span *ngIf="person.date_of_birth">
                ({{ person.date_of_birth | date: "yyyy" }})
              </span>
            </option>
          </select>
        </div>

        <div class="form-group">
          <label for="father">Vater</label>
          <select id="father" name="father" ngModel [disabled]="isLoading">
            <option [value]="null">-- Keine --</option>
            <option *ngFor="let person of allPersons" [value]="person.id">
              {{ person.first_name }} {{ person.last_name }}
              <span *ngIf="person.date_of_birth">
                ({{ person.date_of_birth | date: "yyyy" }})
              </span>
            </option>
          </select>
        </div>
      </div>

      <!-- Account Creation Section -->
      <div class="account-section">
        <div class="form-group checkbox-group">
          <label>
            <input
              type="checkbox"
              id="createAccount"
              name="createAccount"
              [(ngModel)]="createAccount"
              [disabled]="isLoading"
            />
            Benutzerkonto f체r Login erstellen
          </label>
        </div>

        <div *ngIf="createAccount" class="account-fields">
          <h3>Benutzerkonto Details</h3>

          <div class="row">
            <div class="form-group">
              <label for="username">Benutzername *</label>
              <input
                type="text"
                id="username"
                name="username"
                ngModel
                [required]="createAccount"
                [disabled]="isLoading"
              />
            </div>

            <div class="form-group">
              <label for="email">E-Mail *</label>
              <input
                type="email"
                id="email"
                name="email"
                ngModel
                [required]="createAccount"
                [disabled]="isLoading"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group full-width">
              <label for="password">Passwort *</label>
              <input
                type="password"
                id="password"
                name="password"
                ngModel
                [required]="createAccount"
                [disabled]="isLoading"
                minlength="8"
              />
              <small class="helper-text"
                >Mindestens 8 Zeichen erforderlich</small
              >
            </div>
          </div>
        </div>
      </div>

      <div class="button-group">
        <button
          type="submit"
          [disabled]="!personForm.valid || isLoading"
          class="btn-primary"
        >
          {{ isLoading ? "Erstelle..." : "Person erstellen" }}
        </button>

        <button
          type="button"
          (click)="closeModal()"
          [disabled]="isLoading"
          class="btn-secondary"
        >
          Abbrechen
        </button>
      </div>
    </form>
  </div>
</div>
